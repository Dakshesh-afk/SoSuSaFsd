@using SoSuSaFsd.Domain
@using SoSuSaFsd.Components.Common

@* ProfilePostsFeed - Displays posts from a user's profile using SharedPostFeed *@

<h2 style="margin-bottom: 20px;">Posts by @(ProfileUserName ?? "User")</h2>

@if (Posts != null && Posts.Any())
{
    <SharedPostFeed 
        Posts="@Posts"
        CurrentUser="@CurrentUser"
        EmptyStateTitle=""
        EmptyStateMessage=""
        ShowComments="@ShowComments"
        PostComments="@PostComments"
        CommentDrafts="@CommentDrafts"
        CarouselIndices="@CarouselIndices"
        ActiveReplyBoxes="@ActiveReplyBoxes"
        ReplyDrafts="@ReplyDrafts"
        OnLike="@OnLike"
        OnComment="@OnComment"
        OnReport="@OnReport"
        OnUpdateDraft="@OnUpdateDraft"
        OnSubmitComment="@OnSubmitComment"
        OnCarouselChange="@OnCarouselChange"
        OnToggleReply="@OnToggleReply"
        OnUpdateReplyDraft="@OnUpdateReplyDraft"
        OnSubmitReply="@OnSubmitReply" />
}
else
{
    <div class="empty-state center">
        @(ProfileUserName ?? "User") hasn't posted yet.
    </div>
}

@code {
    /// <summary>
    /// Posts to display
    /// </summary>
    [Parameter]
    public List<Posts> Posts { get; set; } = new();

    /// <summary>
    /// Profile user's display name
    /// </summary>
    [Parameter]
    public string? ProfileUserName { get; set; }

    /// <summary>
    /// Currently logged-in user
    /// </summary>
    [Parameter]
    public Users? CurrentUser { get; set; }

    /// <summary>
    /// Tracks which posts have comments visible
    /// </summary>
    [Parameter]
    public Dictionary<int, bool> ShowComments { get; set; } = new();

    /// <summary>
    /// Comments for each post
    /// </summary>
    [Parameter]
    public Dictionary<int, List<Comments>> PostComments { get; set; } = new();

    /// <summary>
    /// Comment drafts
    /// </summary>
    [Parameter]
    public Dictionary<int, string> CommentDrafts { get; set; } = new();

    /// <summary>
    /// Carousel indices
    /// </summary>
    [Parameter]
    public Dictionary<int, int> CarouselIndices { get; set; } = new();

    /// <summary>
    /// Active reply boxes
    /// </summary>
    [Parameter]
    public Dictionary<int, bool> ActiveReplyBoxes { get; set; } = new();

    /// <summary>
    /// Reply drafts
    /// </summary>
    [Parameter]
    public Dictionary<int, string> ReplyDrafts { get; set; } = new();

    /// <summary>
    /// Callback when post is liked
    /// </summary>
    [Parameter]
    public EventCallback<int> OnLike { get; set; }

    /// <summary>
    /// Callback when comments are toggled
    /// </summary>
    [Parameter]
    public EventCallback<int> OnComment { get; set; }

    /// <summary>
    /// Callback when post is reported
    /// </summary>
    [Parameter]
    public EventCallback<int> OnReport { get; set; }

    /// <summary>
    /// Callback when comment draft is updated
    /// </summary>
    [Parameter]
    public EventCallback<PostCard.CommentDraftEventArgs> OnUpdateDraft { get; set; }

    /// <summary>
    /// Callback when comment is submitted
    /// </summary>
    [Parameter]
    public EventCallback<int> OnSubmitComment { get; set; }

    /// <summary>
    /// Callback when carousel changes
    /// </summary>
    [Parameter]
    public EventCallback<PostCard.CarouselEventArgs> OnCarouselChange { get; set; }

    /// <summary>
    /// Callback when reply box is toggled
    /// </summary>
    [Parameter]
    public EventCallback<int> OnToggleReply { get; set; }

    /// <summary>
    /// Callback when reply draft is updated
    /// </summary>
    [Parameter]
    public EventCallback<PostCard.ReplyDraftEventArgs> OnUpdateReplyDraft { get; set; }

    /// <summary>
    /// Callback when reply is submitted
    /// </summary>
    [Parameter]
    public EventCallback<PostCard.SubmitReplyEventArgs> OnSubmitReply { get; set; }
}
